(()=>{function V(t){t.directive("prettyembedconsent",(e,{value:i})=>{if(i==="accept"){K({element:e,Alpine:t});return}z({element:e,Alpine:t})})}function z({element:t,Alpine:e}){e.bind(t,{"x-show"(){return this.gdpr=="isOpen"},"x-transition.opacity"(){}})}function K({element:t,Alpine:e}){e.bind(t,{"@click"(i){i.preventDefault(),this.acceptGdpr()}})}var A=!1,I=!1;function x(t,e){let i=document.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("defer",!0),i.setAttribute("src",t),typeof e=="function"&&i.addEventListener("load",e),document.head.appendChild(i)}function D(t){let e=()=>{$(()=>window.Vimeo,t)};if(I){e();return}I=!0,x("https://player.vimeo.com/api/player.js",e)}function k(t){let e=()=>{$(()=>window.YT?.loaded,t)};if(A){e();return}A=!0,x("https://www.youtube.com/iframe_api",e)}function J(t,e){let i=window.requestAnimationFrame,o=Date.now(),s=!1,n=()=>{Date.now()-o<e?s||i(n):t()};return i(n),{clear:()=>s=!0}}function $(t,e,i=100){if(!(typeof t!="function"&&typeof e!="function"||i<=0)){if(t()){e();return}i--,J(()=>$(t,e,i),100)}}function b(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement}var j="prettyembed",B="/_Resources/Static/Packages/Jonnitto.PrettyEmbedHelper/Scripts/Hls.js?v=1.5.9";function F(t){t.directive("prettyembedmedia",(e,{value:i,modifiers:o,expression:s},{evaluate:n})=>{if(i==="media"){X({element:e,Alpine:t,src:s});return}let l=o.includes("streaming"),a=o.includes("lightbox")?"lightbox":"inline",d={streaming:l,style:a,...n(s||"{}")};Q({element:e,Alpine:t,options:d})})}function Q({element:t,Alpine:e,options:i}){let{style:o,streaming:s}=i,n={type:null,playing:!1,url:null,id:null,autoplay:!1,loaded:!1,lightbox:o==="lightbox"?!1:null,__media:null},l=s?!Z():null;e.bind(t,{"x-data"(){return{...n,play(){if(this.lightbox!==null&&(this.lightbox=!0),!!this.__media?.paused){if(!this.loaded&&s){if(l){if(this.lightbox){setTimeout(()=>{C(this.__media,this.url)},500);return}C(this.__media,this.url);return}this.__media.src=this.url}if(this.lightbox){setTimeout(()=>{this.__media?.play()},500);return}this.__media?.play()}},pause(a=!1){a&&(this.autoplay||this.__media?.muted)||this.__media?.paused||this.__media?.pause()},reset(){this.autoplay||(this.pause(),this.__media?.currentTime&&(this.__media.currentTime=0),this.loaded=!1)},toogle(){if(this.__media.paused){this.play();return}this.pause()},dispatchEvent(a){let d=this.__media.currentTime;d===this.__media.duration&&(a="finished",!this.__media.loop&&!this.lightbox&&!b()&&this.reset()),this.$dispatch(j,{detail:{event:a,currentTime:d,type:this.type,style:o,autoplay:this.autoplay,url:this.url,id:this.id}})},init(){o==="lightbox"&&this.$watch("lightbox",(a,d)=>{!a&&a!==d&&this.pause()})}}},"@prettyembedPauseInternal.window"({detail:a}){a!=this.$root&&this.pause(!0)}})}function X({element:t,Alpine:e,src:i}){let s=t.tagName.toLowerCase()==="video"?"Video":"Audio";e.bind(t,{"x-init"(){this.__media=t,this.url=i||t.currentSrc,this.id=this.url.split("/").pop(),this.autoplay=t.autoplay,this.type=s},"@play"(){this.loaded||(this.loaded=!0),this.playing=!0,!this.autoplay&&!this.muted&&(this.$dispatch("prettyembedPauseInternal",this.$root),this.dispatchEvent("play"))},"@pause"(){this.playing=!1,this.autoplay=!1,this.muted||this.dispatchEvent("pause")}})}function Z(){return!!document.createElement("video").canPlayType("application/vnd.apple.mpegurl")}function C(t,e){if(typeof window.Hls<"u"){L(t,e);return}x(B,()=>{setTimeout(()=>L(t,e),10)})}function L(t,e){let i=window.Hls;if(!i||!i.isSupported())return;let o=new i;o.loadSource(e),o.attachMedia(t),o.on(i.Events.MEDIA_ATTACHED,()=>t.play())}function H(t){t.magic("prettyembedPause",()=>N),t.magic("prettyembedReset",()=>Y),t.magic("prettyembedPlay",()=>R)}window.addEventListener("prettyembedReset",({detail:t})=>Y(t));window.addEventListener("prettyembedPause",({detail:t})=>N(t));window.addEventListener("prettyembedPlay",({detail:t})=>R(t));function Y(t){return S(t).forEach(e=>{let i=window.Alpine.$data(e);typeof i.reset=="function"&&i.reset()})}function N(t){return S(t).forEach(e=>{let i=window.Alpine.$data(e);typeof i.pause=="function"&&i.pause(!0)})}function R(t){return S(t).every(e=>{let i=window.Alpine.$data(e);return typeof i.play=="function"?(i.play(),!1):!0})}var P="jonnitto-prettyembed";function S(t){if(typeof t=="string"){let e=et(t),i=[];return[...document.querySelectorAll(e)].forEach(o=>{i=[...i,...G(o)]}),i}return G(t)}var tt=["youtube","vimeo","video","audio"];function et(t){let e=t.toLowerCase();return tt.includes(e)?`.${P}--${e}`:t}function G(t){if(!(t instanceof Element))t=document;else if(t.classList.contains(P))return[t];return[...t.querySelectorAll(`.${P}`)]}function M(t){t.directive("prettyembedpopup",(e,{expression:i},{evaluate:o})=>{let s=window.getComputedStyle(e).getPropertyValue("--aspect-ratio")||"16 / 9",{ratio:n}=o(`{ratio:${s}}`),l=i||e.href;t.bind(e,{"@click"(a){a.preventDefault();let d=Math.min(window.innerWidth,1260),y=d/n,c=(screen.width-d)/2,f=(screen.height-y)/2;window.open(l,"_blank",`noopener=yes,directories=no,titlebar=no,toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=yes,width=${d},height=${y},left=${c},top=${f}`)}})})}var O="prettyembed";function q(t){t.directive("prettyembedvimeo",(e,{modifiers:i,expression:o},{evaluate:s})=>{let n=i.includes("lightbox")?"lightbox":"inline",l=i.includes("slim"),a={style:n,slim:l,...s(o||"{}")};it({element:e,Alpine:t,options:a})})}function it({element:t,Alpine:e,options:i}){let o="Vimeo",{style:s,slim:n,video:l,color:a,loop:d,gdpr:y,background:c}=i,f={id:l,autopip:!0,autoplay:!0,pip:!0,portrait:!1,responsive:!1,title:!1,byline:!1,background:!!c,loop:!!d,autopause:!1,controls:!n};a&&(f.color=a);let w=window.localStorage,_=`jonnittoprettyembed_gdpr_${o.toLowerCase()}`,p={loaded:!1,playing:!1,lightbox:s==="lightbox"?!1:null,gdpr:y&&w.getItem(_)!=="true"?"needCheck":"isAccepted"},r=null;e.bind(t,{"x-data"(){return{...p,init(){this.lightbox!==null&&this.$watch("lightbox",(u,h)=>{!u&&u!==h&&this.pause()})},acceptGdpr(){w.setItem(_,"true"),this.$dispatch("prettyembedAcceptGdpr",o),this.load()},play(){r?.play()},pause(){r?.pause()},load(u){if(u&&u.preventDefault(),this.gdpr!="isAccepted"){this.gdpr="isOpen";return}if(this.lightbox!==null&&(this.lightbox=!0),this.loaded){this.play();return}D(()=>{let h=this.$refs?.vimeo||t;r=new window.Vimeo.Player(h,f);let m=async g=>{let W=[r.getVideoTitle(),r.getVideoId(),r.getVideoUrl(),r.getCurrentTime(),r.getEnded()],v=await Promise.allSettled(W);return v[4].value&&(g="finished",!d&&!this.lightbox&&!b()&&this.reset()),{event:g,type:o,style:s,title:v[0].value,videoID:v[1].value,videoUrl:v[2].value,currentTime:v[3].value}};r.on("play",async()=>{let g=await m("play");this.$dispatch("prettyembedPauseInternal",t),this.loaded=!0,this.playing=!0,this.$dispatch(O,g)}),r.on("pause",async()=>{let g=await m("pause");this.playing=!1,this.$dispatch(O,g)})})},async reset(){r&&(await this.pause(),await r.destroy(),r=null,this.loaded=!1,this.playing=!1)}}},"@prettyembedAcceptGdpr.window"({detail:u}){u==o&&(this.gdpr="isAccepted")},"@prettyembedPauseInternal.window"({detail:u}){u!=this.$root&&this.pause()}})}var E="prettyembed";function U(t){t.directive("prettyembedyoutube",(e,{modifiers:i,expression:o},{evaluate:s})=>{let n=i.includes("lightbox")?"lightbox":"inline",a={slim:i.includes("slim"),style:n,...s(o||"{}")};ot({element:e,Alpine:t,options:a})})}function ot({element:t,Alpine:e,options:i}){let o="YouTube",{video:s,playlist:n,style:l,slim:a,loop:d,noCookie:y}=i,c={playerVars:{autoplay:1,modestbranding:1,playsinline:1,rel:0,showinfo:0,controls:a?0:1,loop:d?1:0}};y&&(c.host="https://www.youtube-nocookie.com"),s&&(c.videoId=s),n&&(n.startsWith("PL")||(n="PL"+n),c.playerVars.listType="playlist",c.playerVars.list=n);let f=window.localStorage,w=`jonnittoprettyembed_gdpr_${o.toLowerCase()}`,_={title:i.title,loaded:!1,playing:!1,lightbox:l==="lightbox"?!1:null,gdpr:i.gdpr&&f.getItem(w)!=="true"?"needCheck":"isAccepted"},p=null;e.bind(t,{"x-data"(){return{..._,init(){this.ligtbox!==null&&this.$watch("lightbox",(r,u)=>{!r&&r!==u&&this.pause()})},acceptGdpr(){f.setItem(w,"true"),this.$dispatch("prettyembedAcceptGdpr",o),this.load()},play(){p?.playVideo()},pause(){p?.pauseVideo()},load(r){if(r&&r.preventDefault(),this.gdpr!="isAccepted"){this.gdpr="isOpen";return}if(this.lightbox!==null&&(this.lightbox=!0),this.loaded){this.play();return}k(()=>{let u=this.$refs?.youtube||t,h=window.YT;p=new h.Player(u,{...c,events:{onStateChange:({data:m})=>{setTimeout(()=>{if(m===h.PlayerState.PLAYING){this.$dispatch("prettyembedPauseInternal",t),this.loaded=!0,this.playing=!0,this.$dispatch(E,T({event:"play",type:o,style:l,player:p}));return}if(m===h.PlayerState.PAUSED){this.playing=!1,this.$dispatch(E,T({event:"pause",type:o,style:l,player:p}));return}m===h.PlayerState.ENDED&&(this.playing=!1,!d&&!this.lightbox&&!b()&&this.reset(),this.$dispatch(E,T({event:"finished",type:o,style:l,player:p})))},10)}}})})},reset(){p&&(p?.stopVideo(),p.destroy(),p=null,this.loaded=!1,this.playing=!1)}}},"@prettyembedAcceptGdpr.window"({detail:r}){r==o&&(this.gdpr="isAccepted")},"@prettyembedPauseInternal.window"({detail:r}){r!=this.$root&&this.pause()}})}function T({player:t,type:e,style:i,event:o}){let s,n=0,l={};try{s=t?.getVideoUrl()||null,n=t?.getCurrentTime()||0,l=t?.getVideoData()||{}}catch{}return{event:o,type:e,style:i,title:l?.title,author:l?.author,videoUrl:s,currentTime:n,videoID:l?.video_id,quality:l?.video_quality,playlistID:l?.list||null}}window.addEventListener("alpine:init",()=>{window.Alpine.plugin([V,F,H,M,q,U])});})();
